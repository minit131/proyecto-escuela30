<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#87CEEB">
    <title>Portal del Colegio</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Modal de Login -->
    <div id="login-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h2 id="modal-title">Iniciar SesiÃ³n</h2>
            
            <!-- Formulario de Login -->
            <div id="login-form" class="auth-form">
                <input type="text" id="login-username" placeholder="Usuario">
                <input type="password" id="login-password" placeholder="ContraseÃ±a">
                <button onclick="login()">Iniciar SesiÃ³n</button>
                <p>Â¿No tienes cuenta? <a href="#" onclick="showRegister()">RegÃ­strate aquÃ­</a></p>
            </div>

            <!-- Formulario de Registro -->
            <div id="register-form" class="auth-form hidden">
                <input type="text" id="register-username" placeholder="Usuario">
                <input type="email" id="register-email" placeholder="Email">
                <input type="password" id="register-password" placeholder="ContraseÃ±a">
                <input type="password" id="register-confirm" placeholder="Confirmar contraseÃ±a">
                <button onclick="register()">Registrarse</button>
                <p>Â¿Ya tienes cuenta? <a href="#" onclick="showLogin()">Inicia sesiÃ³n aquÃ­</a></p>
            </div>
        </div>
    </div>

    <!-- Barra de navegaciÃ³n superior -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <h2>ğŸ“ Colegio San JosÃ©</h2>
            </div>
            <ul class="nav-menu">
                <li><a href="#inicio">Inicio</a></li>
                <li><a href="#noticias">Noticias</a></li>
                <li><a href="#eventos">Eventos</a></li>
                <li><a href="#galeria">GalerÃ­a</a></li>
                <li><a href="#contacto">Contacto</a></li>
                <li id="auth-button"><a href="#" onclick="openLoginModal()">Iniciar SesiÃ³n</a></li>
            </ul>
            <div class="hamburger" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Panel de usuario logueado -->
    <div id="user-panel" class="user-panel hidden">
        <div class="user-info">
            <span id="welcome-user">Bienvenido, Usuario</span>
            <span id="user-role" class="role-badge">Usuario</span>
        </div>
        <div class="user-actions">
            <button id="admin-panel-btn" class="hidden" onclick="toggleAdminPanel()">Panel Admin</button>
            <button onclick="logout()">Cerrar SesiÃ³n</button>
        </div>
    </div>

    <!-- Contenido principal -->
    <main class="main-content">
        <!-- Panel de administraciÃ³n -->
        <div id="admin-panel" class="admin-panel hidden">
            <div class="admin-header">
                <h3>ğŸ“ Panel de AdministraciÃ³n</h3>
                <button class="close-btn" onclick="toggleAdminPanel()">Ã—</button>
            </div>
            
            <!-- Tabs de administraciÃ³n -->
            <div class="admin-tabs">
                <button class="tab-btn active" onclick="showTab('news-tab', event)">Gestionar Noticias</button>
<button class="tab-btn" onclick="showTab('users-tab', event)">Gestionar Usuarios</button>

            </div>

            <!-- Tab de Noticias -->
            <div id="news-tab" class="tab-content">
                <div class="admin-form">
                    <h4>Publicar Nueva Noticia</h4>
                    <input type="text" id="news-title" placeholder="TÃ­tulo de la noticia">
                    <textarea id="news-content" placeholder="Contenido de la noticia" rows="4"></textarea>
                    <div class="file-uploads">
                        <div class="upload-group">
                            <label for="image-upload">ğŸ“· Subir Imagen:</label>
                            <input type="file" id="image-upload" accept="image/*">
                        </div>
                        <div class="upload-group">
                            <label for="audio-upload">ğŸµ Subir Audio:</label>
                            <input type="file" id="audio-upload" accept="audio/*">
                        </div>
                    </div>
                    <button onclick="addNews()" class="publish-btn">ğŸ“¤ Publicar Noticia</button>
                </div>

                <div class="news-management">
                    <h4>Noticias Publicadas</h4>
                    <div id="admin-news-list" class="admin-news-list">
                        <!-- Se llenarÃ¡n las noticias con opciÃ³n de eliminar -->
                    </div>
                </div>
            </div>

            <!-- Tab de Usuarios -->
            <div id="users-tab" class="tab-content hidden">
                <div class="users-management">
                    <h4>GestiÃ³n de Usuarios</h4>
                    <div id="users-list" class="users-list">
                        <!-- Se llenarÃ¡ con la lista de usuarios -->
                    </div>
                </div>
            </div>
        </div>

        <!-- SecciÃ³n de bienvenida -->
        <section class="hero-section">
            <div class="hero-content">
                <h1>ğŸŒŸ Bienvenidos al Portal del Colegio</h1>
                <p>Mantente informado sobre todas las novedades y eventos de nuestra instituciÃ³n educativa</p>
                <div class="hero-stats">
                    <div class="stat">
                        <span class="stat-number" id="news-count">2</span>
                        <span class="stat-label">Noticias</span>
                    </div>
                    <div class="stat">
                        <span class="stat-number">500+</span>
                        <span class="stat-label">Estudiantes</span>
                    </div>
                    <div class="stat">
                        <span class="stat-number">25</span>
                        <span class="stat-label">Profesores</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- SecciÃ³n de noticias -->
        <section class="news-section" id="noticias">
            <div class="container">
                <h2>ğŸ“° Ãšltimas Noticias</h2>
                <div id="news-container" class="news-grid">
                    <!-- Noticia de ejemplo -->
                    <div class="news-card" data-news-id="1">
                        <div class="news-header">
                            <h3>ğŸ“ Bienvenida al nuevo aÃ±o escolar</h3>
                            <div class="news-actions hidden">
                                <button class="delete-btn" onclick="deleteNews(1)">ğŸ—‘ï¸</button>
                            </div>
                        </div>
                        <p>Damos la bienvenida a todos nuestros estudiantes al nuevo perÃ­odo acadÃ©mico 2025. Estamos emocionados por comenzar este nuevo ciclo lleno de aprendizaje y crecimiento.</p>
                        <div class="news-meta">
                            <span class="date">ğŸ“… 10 de Agosto, 2025</span>
                            <span class="author">ğŸ‘¤ Administrador</span>
                        </div>
                    </div>
                    
                    <div class="news-card" data-news-id="2">
                        <div class="news-header">
                            <h3>ğŸƒâ€â™‚ï¸ Nuevas instalaciones deportivas</h3>
                            <div class="news-actions hidden">
                                <button class="delete-btn" onclick="deleteNews(2)">ğŸ—‘ï¸</button>
                            </div>
                        </div>
                        <p>Nos complace anunciar la inauguraciÃ³n de nuestras nuevas instalaciones deportivas que incluyen una cancha de bÃ¡squet renovada y un Ã¡rea de ejercicios al aire libre.</p>
                        <div class="news-meta">
                            <span class="date">ğŸ“… 5 de Agosto, 2025</span>
                            <span class="author">ğŸ‘¤ Administrador</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>ğŸ“ Contacto</h3>
                    <p>ğŸ“§ info@colegiosanjose.edu.ar</p>
                    <p>ğŸ“ (011) 4567-8900</p>
                    <p>ğŸ  amdonaegui 3143, Buenos Aires</p>
                </div>
                <div class="footer-section">
                    <h3>â° Horarios</h3>
                    <p>ğŸ“… Lunes a Viernes: 7:00 - 18:00</p>
                </div>
                <div class="footer-section">
                    <h3>ğŸŒ SÃ­guenos</h3>
                    <p>ğŸ“± Facebook | Instagram | Twitter</p>
                    <p>ğŸ’» Portal Educativo Online</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Colegio 30 Vitor Mercante. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <script>
        // Sistema de usuarios y autenticaciÃ³n
        let users = JSON.parse(localStorage.getItem('school_users') || '{}');
        let currentUser = null;
        let newsIdCounter = 3; // Empezamos con 3 porque ya hay 2 noticias

        // Inicializar usuario admin por defecto
        if (Object.keys(users).length === 0) {
            users['admin'] = {
                username: 'admin',
                email: 'admin@colegio.edu',
                password: 'admin123',
                role: 'admin',
                created: new Date().toISOString()
            };
            localStorage.setItem('school_users', JSON.stringify(users));
        }

        // Funciones de Modal
        function openLoginModal() {
            document.getElementById('login-modal').classList.remove('hidden');
            showLogin();
        }

        function closeModal() {
            document.getElementById('login-modal').classList.add('hidden');
        }

        function showLogin() {
            document.getElementById('modal-title').textContent = 'Iniciar SesiÃ³n';
            document.getElementById('login-form').classList.remove('hidden');
            document.getElementById('register-form').classList.add('hidden');
        }

        function showRegister() {
            document.getElementById('modal-title').textContent = 'Crear Cuenta';
            document.getElementById('login-form').classList.add('hidden');
            document.getElementById('register-form').classList.remove('hidden');
        }

        // Funciones de autenticaciÃ³n
        function login() {
            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;

            if (!username || !password) {
                alert('Por favor, completa todos los campos');
                return;
            }

            if (users[username] && users[username].password === password) {
                currentUser = users[username];
                updateUI();
                closeModal();
                alert('Â¡Bienvenido, ' + username + '!');
            } else {
                alert('Usuario o contraseÃ±a incorrectos');
            }
        }

        function register() {
            const username = document.getElementById('register-username').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const confirm = document.getElementById('register-confirm').value;

            if (!username || !email || !password || !confirm) {
                alert('Por favor, completa todos los campos');
                return;
            }

            if (password !== confirm) {
                alert('Las contraseÃ±as no coinciden');
                return;
            }

            if (users[username]) {
                alert('El usuario ya existe');
                return;
            }

            users[username] = {
                username: username,
                email: email,
                password: password,
                role: 'user',
                created: new Date().toISOString()
            };

            localStorage.setItem('school_users', JSON.stringify(users));
            alert('Cuenta creada exitosamente. Ahora puedes iniciar sesiÃ³n.');
            showLogin();
        }

        function logout() {
            currentUser = null;
            updateUI();
            alert('SesiÃ³n cerrada exitosamente');
        }

        // Actualizar interfaz segÃºn el usuario
        function updateUI() {
            const authButton = document.getElementById('auth-button');
            const userPanel = document.getElementById('user-panel');
            const adminPanelBtn = document.getElementById('admin-panel-btn');
            const newsActions = document.querySelectorAll('.news-actions');

            if (currentUser) {
                authButton.classList.add('hidden');
                userPanel.classList.remove('hidden');
                document.getElementById('welcome-user').textContent = `Bienvenido, ${currentUser.username}`;
                document.getElementById('user-role').textContent = currentUser.role === 'admin' ? 'Administrador' : 'Usuario';
                document.getElementById('user-role').className = `role-badge ${currentUser.role}`;

                if (currentUser.role === 'admin') {
                    adminPanelBtn.classList.remove('hidden');
                    newsActions.forEach(action => action.classList.remove('hidden'));
                } else {
                    adminPanelBtn.classList.add('hidden');
                    newsActions.forEach(action => action.classList.add('hidden'));
                }
            } else {
                authButton.classList.remove('hidden');
                userPanel.classList.add('hidden');
                document.getElementById('admin-panel').classList.add('hidden');
                newsActions.forEach(action => action.classList.add('hidden'));
            }

            updateUsersList();
        }

        // Funciones del panel de administraciÃ³n
        function toggleAdminPanel() {
            const panel = document.getElementById('admin-panel');
            panel.classList.toggle('hidden');
            if (!panel.classList.contains('hidden')) {
                updateAdminNewsList();
                updateUsersList();
            }
        }

        function showTab(tabId, event) {
    document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
    document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
    document.getElementById(tabId).classList.remove('hidden');
    event.target.classList.add('active');
}

        function addNews() {
            if (!currentUser || currentUser.role !== 'admin') {
                alert('No tienes permisos para publicar noticias');
                return;
            }

            const title = document.getElementById('news-title').value;
            const content = document.getElementById('news-content').value;
            const imageFile = document.getElementById('image-upload').files[0];
            const audioFile = document.getElementById('audio-upload').files[0];

            if (!title || !content) {
                alert('Por favor, completa el tÃ­tulo y contenido de la noticia');
                return;
            }

            const newsContainer = document.getElementById('news-container');
            const newsCard = document.createElement('div');
            newsCard.className = 'news-card';
            newsCard.setAttribute('data-news-id', newsIdCounter);

            let mediaContent = '';
            
            if (imageFile) {
                const imageURL = URL.createObjectURL(imageFile);
                mediaContent += `<img src="${imageURL}" alt="${title}" class="news-image">`;
            }
            
            if (audioFile) {
                const audioURL = URL.createObjectURL(audioFile);
                mediaContent += `<audio controls class="news-audio"><source src="${audioURL}" type="${audioFile.type}">Tu navegador no soporta audio.</audio>`;
            }

            const currentDate = new Date().toLocaleDateString('es-AR', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });

            newsCard.innerHTML = `
                <div class="news-header">
                    <h3>${title}</h3>
                    <div class="news-actions${currentUser && currentUser.role === 'admin' ? '' : ' hidden'}">
                        <button class="delete-btn" onclick="deleteNews(${newsIdCounter})">ğŸ—‘ï¸</button>
                    </div>
                </div>
                ${mediaContent}
                <p>${content}</p>
                <div class="news-meta">
                    <span class="date">ğŸ“… ${currentDate}</span>
                    <span class="author">ğŸ‘¤ ${currentUser.username}</span>
                </div>
            `;

            newsContainer.insertBefore(newsCard, newsContainer.firstChild);
            newsIdCounter++;

            // Actualizar contador
            document.getElementById('news-count').textContent = document.querySelectorAll('.news-card').length;

            // Limpiar formulario
            document.getElementById('news-title').value = '';
            document.getElementById('news-content').value = '';
            document.getElementById('image-upload').value = '';
            document.getElementById('audio-upload').value = '';

            updateAdminNewsList();
        }

        function deleteNews(newsId) {
            if (!currentUser || currentUser.role !== 'admin') {
                alert('No tienes permisos para eliminar noticias');
                return;
            }

            if (confirm('Â¿EstÃ¡s seguro de que quieres eliminar esta noticia?')) {
                const newsCard = document.querySelector(`[data-news-id="${newsId}"]`);
                if (newsCard) {
                    newsCard.remove();
                    document.getElementById('news-count').textContent = document.querySelectorAll('.news-card').length;
                    updateAdminNewsList();
                }
            }
        }

        function updateAdminNewsList() {
            const adminNewsList = document.getElementById('admin-news-list');
            const newsCards = document.querySelectorAll('.news-card');
            
            adminNewsList.innerHTML = '';
            newsCards.forEach(card => {
                const title = card.querySelector('h3').textContent;
                const date = card.querySelector('.date').textContent;
                const newsId = card.getAttribute('data-news-id');
                
                const listItem = document.createElement('div');
                listItem.className = 'admin-news-item';
                listItem.innerHTML = `
                    <span class="news-info">
                        <strong>${title}</strong>
                        <small>${date}</small>
                    </span>
                    <button class="delete-btn" onclick="deleteNews(${newsId})">ğŸ—‘ï¸ Eliminar</button>
                `;
                adminNewsList.appendChild(listItem);
            });
        }

        function updateUsersList() {
            if (!currentUser || currentUser.role !== 'admin') return;

            const usersList = document.getElementById('users-list');
            usersList.innerHTML = '';

            Object.values(users).forEach(user => {
                const userItem = document.createElement('div');
                userItem.className = 'user-item';
                userItem.innerHTML = `
                    <div class="user-info-admin">
                        <strong>${user.username}</strong>
                        <span>${user.email}</span>
                        <span class="role-badge ${user.role}">${user.role === 'admin' ? 'Administrador' : 'Usuario'}</span>
                    </div>
                    <div class="user-actions-admin">
                        <select onchange="changeUserRole('${user.username}', this.value)">
                            <option value="user" ${user.role === 'user' ? 'selected' : ''}>Usuario</option>
                            <option value="admin" ${user.role === 'admin' ? 'selected' : ''}>Administrador</option>
                        </select>
                        ${user.username !== 'admin' ? `<button class="delete-btn" onclick="deleteUser('${user.username}')">ğŸ—‘ï¸</button>` : ''}
                    </div>
                `;
                usersList.appendChild(userItem);
            });
        }

        function changeUserRole(username, newRole) {
            if (users[username]) {
                users[username].role = newRole;
                localStorage.setItem('school_users', JSON.stringify(users));
                alert(`El rol de ${username} ha sido cambiado a ${newRole === 'admin' ? 'Administrador' : 'Usuario'}`);
                updateUsersList();
            }
        }

        function deleteUser(username) {
            if (confirm(`Â¿EstÃ¡s seguro de que quieres eliminar el usuario ${username}?`)) {
                delete users[username];
                localStorage.setItem('school_users', JSON.stringify(users));
                updateUsersList();
            }
        }

        // MenÃº hamburguesa para mÃ³vil
        function toggleMenu() {
            const navMenu = document.querySelector('.nav-menu');
            navMenu.classList.toggle('active');
        }

        // Inicializar la pÃ¡gina
        document.addEventListener('DOMContentLoaded', function() {
            updateUI();
            
            // Cerrar modal al hacer click fuera
            window.onclick = function(event) {
                const modal = document.getElementById('login-modal');
                if (event.target === modal) {
                    closeModal();
                }
            }
        });
    </script>
</body>
</html>